from libmproxy.protocol.http import decoded
from libmproxy.protocol.http import HTTPResponse
import json


def response(context, flow):

    """
    Read request body from /load resource and tamper temperature value.

    NOT TESTED YET!
    """

    request_url = flow.request.pretty_url(hostheader=True)
    if 'load' in request_url:
        with decoded(flow.response):
            body = json.loads(flow.response.content)
            if body.get('value'):
                body['value'] = 100
            flow.response.content = json.dumps(body)